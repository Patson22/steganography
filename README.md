# steganography
# The Objective:
The objective was to create a program to perform __steganography__. _Steganography is the practice of representing information within another message or physical object, in such a manner that the presence of the information is not evident to human inspection._
This program is expected to be able to encode and decode secret messages within a PPM file.
# Program design
## Program design based on tasks given :


### **1. Storing PPM images**
This task was concerned with the definition of the __struct PPM__.  
__struct PPM__ held the data a standard plain PPM file would hold<br>
these were:
1. PPM format/magic number.  
2. Width.  
3. Height.  
4. Max (the max value an RGB pixel could hold).  
5. pixel data. </ol> 
The magic number is stored as a string and a pointer to that string is what will be stored in the struct PPM as '__format__'.  
The _width_, __height__ and __max__ are stored as int values.  
The pixel data will be an array of type __struct Pixel__, a pointer to that array is what will be stored in the struct PPM as '__rgbArr__'.  

### **2.PPM Functions**
#### **2a - Reading PPM files**
This task is concerned with reading an already opened PPM file __f__ using the function __struct PPM *getPPM(FILE *f);__.  
This function would take in the opened file f and perform read operations to extract information about the PPM file. 

We use __scanf()__ to read data from the PPM file.   
We store the information in a struct PPM called as __thePpmFile__ which will be returned.  

In this function to make sure the pixel data is stored properly in __thePpmFile->rgbArr__ we have to dynamically allocate memory for it using the __malloc()__ function. We assign enough memory so that it can accommodate the __(width*height)__ rows of pixels.  
#### **2a - Writing PPM files**
This task is concerned with the displaying of the struct PPM onto __stdout__ which is done using the function __void showPPM(const struct PPM *img)__  
The __struct PPM *img__ which is passed as an argument is generated by __getPPM(f)__, where __f__ is the file which was passed as an argument when the function was called.  

We display contents of the chosen PPM onto __stdout__ using __printf()__ and display the information in the following syntax :   
| P3  
| width height  
| max  
| r1 g1 b1  
| r2 g2 b2  
| ....   

For the display of pixel data, a simple for loop is used to iterate through the pixel values.

#### **2c - Encode Data**
This task is concerned with encoding the inputted PPM file and having a text hidden in a successive random order within the red pixels of a copy of a struct PPM using the function __struct PPM *encode(const char *text, const struct PPM *img)__.  

To encode the text into an image, we have to invoke the program as  
| __./steg e old.ppm >new.ppm__  
This command line argument invokes the program in __'encode mode'__ and a prompt will show up to enter a text of what is to be hidden within the ppm image __'old.ppm'__. The __'>'__ in the above line is known as output redirection, whatever stdout is displayed while the program runs will be stored in the file after __'>'__ character, which in the above case is **'new.ppm'** .   

To implement the successive random insertion of the text message within the data red pixels I made a helper function __int *randArr(int length, int min, int max)__ .  
This helper function is used to make an array of unique random integers using __rand()__ function and specifying __min__ and __max__ index for the random values.  
The min and max were 0 and __number of rows of PPM file__ respectively.  

To help with the ordered insertion of the text into the pixels I also made another helper function __int *bubbleSort(int arr[], int length)__ which implements bubble sort to sort the generated random array of indices.

The insertion of text within the red pixels of the struct PPM is done in such a way that the ASCII value of the character inserted isn't the same as the red pixel's original value.

#### **2d - Decode Data**
This task was concerned with decoding an already encoded PPM file by comparing it with a PPM file that wasn't encoded and then displaying the secret message in __stdout__. The decoding of the PPM files is done using the function __char *decode(const struct PPM *oldimg, const struct PPM *newimg)__. 

To run the program in decode mode we have to invoke it like  
| __./steg d old.ppm new.ppm__ 

The function __decode__ first checks if the two PPM files have the same dimensions (width and height). Once it is established that the two files are of the same dimensions the comparing of red pixels is done using a loop and we identify the changes in new.ppm with old.ppm .  

The decoded secret text is returned to the __main__ function.
### **3. Impementation of steganography program**
Completion of the main behaviour of the steg program is done here using the __main__ function.  

We first check the number of command line arguments passed, if it is __3__ (argc == 3) it must be in __t__ (testing) or __e__ (encoding) mode. If the number of arguments is _4_ (argc == 4) then the program must be in __d__ (decoding) mode.  
If these conditions aren't met an error will be raised stating _"Unrecognised or incomplete command line."_

When the program is invoked in __t__ mode like  
| __./steg t ppm.file__  
We first do the reading of the PPM and have its data stored in a struct PPM. This struct PPM is then passed for displaying with the help of __showPPM__ function.  

When the program is invoked in __e__ mode like  
| __./steg e old.ppm >new.ppm__  
the prompt for the message to be encoded appears on execution.  
For taking user input I used the function __fgets()__ instead of scanf() as it retains more information about the __stdin__ which makes the encoding better as we won't lose certain characters (like the space character ASCII #32).   
We then call function __encode()__ and pass the text and struct PPM as arguments. The message will then be encoded and the returned struct PPM is then displayed using __showPPM__.  

When the program is invoked in __d__ mode like  
| __./steg d old.ppm new.ppm__  
We call the function __decode__ and pass two struct PPMs as arguments the message decoded is returned and is then displayed to __stdout__.

# Choice of data structures and algorithms
- To encode a message I used a __randArr__ function which uses the __rand()__ functions and along with the specified limits it will generate a random array of numbers which is used as the indices specifying where the characters of our message will be hidden. Within __randArr__, a __linear search__ is also done so that the current number generated is unique.
- The random array of indices is then sorted using the __bubbleSort__ function which implements the __bubble sort algorithm__ so that we can successively encode the characters into the red pixels.
